# 工作进度 Week1



## 数据

- 在CSMAR上找到`机构持股明细表`, 对比参考使用10k文件构建数据集的Asset Embedding 原论文，我认为这是我们需要的数据。

  数据库说明书请见[机构投资者 数据库说明书](https://data.csmar.com/lib/pdfjs/web/viewer.html?file=group1%2FM00%2F43%2F31%2FCuIKV2dD57yAOl9_AAj0f7JdYGg677.pdf&fname=机构投资者 数据库说明书)

- 已完成您发给我的`CRSP_compustat_merge`数据表和Andrew团队数据的预处理管线（详见下文），但我对Andrew的数据不是很明白，如何使用`PlaceboIndv`和`PredictorIndiv`文件夹下同名但不同值的特征？



## 代码

代码仓库：[Carzit/RAWork](https://github.com/Carzit/RAWork)

- 完成了`data_converter.py`，对于股票数据，每个数据文件的组织方式有以下8种可能：
  1. 以因子名为文件名，列名为股票代码，行名为日期
  2. 以因子名为文件名，共有三列，分别为股票代码、日期、因子的数值
  3. 以股票名或股票代码为文件名，列名为因子名，行名为日期
  4. 以股票名或股票代码为文件名，共有三列，分别为日期、因子名、因子的数值
  5. 以日期为文件名，列名为股票代码，行名为因子名
  6. 以日期为文件名，列名为因子名，行名为股票代码
  7. 以日期为文件名，共有三列，分别为股票代码、因子名、因子的数值
  8. 所有数据均在一张表格中，列名包含股票代码、日期和各因子名

​      该管线将其他7种股票数据的组织方式改为6

> 为什么要使用方式6？
>
> 主要是考虑到训练时的IO开销。对于一个三维的股票数据，以股票代码维度为batch维度，以因子名维度为feature维度，以时间维度为seq_length维度。首先，对于较大的数据集，我们无法也无必要将所有数据载入内存，因此，我们在数据集每个index的样本上，需要每次单独地从硬盘载入数据。对于每个样本，所有的因子名和所有对齐后的股票代码都会用到，但时间只会使用有限长度。因此格式6是IO开销最小的格式。

- 正在重构`data_alignment.py`，实现不同数据集（比如量价因子和基本面因子）之间的数据对齐。
